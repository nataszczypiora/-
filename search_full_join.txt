Antipattern search_full_joinselect COALESCE(a.title, b.title), COALESCE(a.year, b.year), COALESCE(a.month, b.month), COALESCE(a.Cadmin_edits, 0), COALESCE(b.Wpart_edits, 0) FROM (SELECT pages.title, YEAR(page_revisions.date) AS year, MONTH(page_revisions.date) AS MONTH, COUNT(revid) AS Cadmin_edits FROM page_revisions INNER JOIN pages ON page_revisions.title=pages.title WHERE userid!=0 AND admin=1 AND pages.ns=0 GROUP BY year, MONTH ORDER BY page_revisions.title, year, MONTH) a FULL JOIN (SELECT pages.title, YEAR(page_revisions.date) AS year, MONTH(page_revisions.date) AS MONTH, COUNT(revid) AS Wpart_edits FROM page_revisions INNER JOIN pages ON page_revisions.title=pages.title WHERE userid!=0 AND wikip_member=1 AND pages.ns=0 GROUP BY year, MONTH ORDER BY page_revisions.title, year, MONTH) b ON a.title = b.title AND a.year = b.year AND a.month = b.month /*order the full results as you please*/
SELECT COALESCE(t1.t_stamp, t2.t_stamp) t_stamp ,SupplyTemp ,Return_temp ,[Weight] ,Jacket_temp FROM Table1 t1 FULL JOIN Table2 t2 ON t1.t_stamp = t2.t_stamp
SELECT t1.id , t2.service , t3.device FROM t1 LEFT JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY id ORDER BY service) AS rn , id , service FROM t2 ) AS t2 FULL JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY id ORDER BY device) AS rn , id , device FROM t3 ) AS t3 ON t3.id = t2.id AND t3.rn = t2.rn ON COALESCE(t2.id, t3.id) = t1.id ;
SELECT dbo.AfterHoursParameterSetup.Customer_id , dbo.tblCustomer.Company , dbo.tblDevices.device_id , dbo.AfterHoursParameterSetup.DeviceMasterID , dbo.tblDriverType.DriverType , dbo.tblGroups.GroupName , dbo.AfterHoursParameterSetup.ReportBy , dbo.AfterHoursParameterSetup.TripTimeFilter , dbo.AfterHoursParameterSetup.chkWeekEndTravel , dbo.AfterHoursParameterSetup.WeekdayStart , dbo.AfterHoursParameterSetup.WeekDayEnd , dbo.AfterHoursParameterSetup.WeekEndFrom , dbo.AfterHoursParameterSetup.WeekEndTo , dbo.AfterHoursParameterSetup.ReportType FROM dbo.AfterHoursParameterSetup FULL JOIN dbo.tblCustomer ON dbo.AfterHoursParameterSetup.Customer_id = dbo.tblCustomer.Customer_id FULL JOIN dbo.tblDriverType ON dbo.AfterHoursParameterSetup.DeviceMasterID = dbo.tblDriverType.DriverType_id FULL JOIN dbo.tblGroups ON dbo.AfterHoursParameterSetup.DeviceMasterID = dbo.tblGroups.Group_id FULL JOIN dbo.tblDevices ON dbo.AfterHoursParameterSetup.DeviceMasterID = dbo.tblDevices.device_id ORDER BY dbo.AfterHoursParameterSetup.Customer_id ASC
SELECT A.*, B.* FROM TABLE1 A FULL JOIN TABLE2 B ON A.Id = B.TableAID
SELECT COALESCE(t1.MyName COLLATE DATABASE_DEFAULT, t2.MyName ) AS MyName ,CASE WHEN t2.MyLevel &gt; t1.MyLevel THEN t2.MyDescr COLLATE DATABASE_DEFAULT ELSE t1.MyDescr END AS MyDescr ,CASE WHEN t2.MyLevel &gt; t1.MyLevel THEN t2.MyLevel ELSE t1.MyLevel END AS MyLevel ,CASE WHEN t2.MyLevel &gt; t1.MyLevel THEN t2.FromDB COLLATE DATABASE_DEFAULT ELSE t1.FromDB END AS FromDB FROM TableOne t1 FULL JOIN TableTwo t2 ON t1.MyName = t2.MyName COLLATE DATABASE_DEFAULT
SelectCommand=SELECT SerialNum, SiteId, Location, ContainerId, Misplaced, Frozen, Scratched, Destroyed, ScratchpoolId, Vendor, Exported, Erased, Bad, Encrypted, Virtual, ReturnDate, ReturnSiteId FROM Media FULL JOIN MediaInfo ON Media.MediaID= MediaInfo.MediaID FULL JOIN MediaStatus ON MediaInfo.MediaID= MediaStatus.MediaID FULL JOIN MediaReturn ON MediaStatus.MediaID= MediaReturn.MediaID FULL JOIN MediaGenT ON Media.NoteID= MediaGenT.NoteID" if(SerialNumber!=null &amp;&amp; SiteID!=null) { SelectCommand+="WHERE (([SerialNum] like '%' + @SerialNum + '%') AND ([SiteId] = @SiteId))" } elseif(SerialNumber.isnull() &amp;&amp; !SiteId.isnull()) { SelectCommand+="WHERE [SiteId] = @SiteId" } elseif(!SerialNumber.isnull() &amp;&amp; SiteId.isnull()) { SelectCommand+="where [SerialNum] like '%' + @SerialNum + '%'" }
SELECT UserP.*, AccountP.* FROM UserP FULL JOIN AccountPON (UserP.Id = AccountP.Id) WHERE UserP.Id NOT IN AccountP.Id
SELECT ISNULL(E.NUM_EMPL,R.NUM_EMP) AS NUM_EMP, E.NAME FROM EMPL E FULL JOIN REG R ON E.NUM_EMPL = R.NUM_EMP
select a.Level_Id ALevelId, b.Level_Id BLevelId, case ISNULL(a.Level_Id, 0) when 0 then 'B' else 'A' end AS Type, case ISNULL(a.Level_Id, 0) when 0 then b.Level_Id else a.Level_Id end AS NewLevel_Id INTO Dummy FROM a FULL JOIN b On (a.Level_ID = b.Level_ID); UPDATE c SET c.Level_id = Dummy.NewLevel_Id from Dummy, c WHERE c.Level_Id = Dummy.ALevelId AND Dummy.Type = 'A'; UPDATE d SET d.Level_id = Dummy.NewLevel_Id from Dummy, d WHERE d.Level_Id = Dummy.BLevelId AND Dummy.Type = 'B'; SELECT Dummy.NewLevel_Id, a.Level, a.LevelDesc As Description INTO YourNewTable from Dummy JOIN a ON (Dummy.ALevelId = a.Level_Id) Where Dummy.Type = 'A' UNION SELECT NewLevel_Id, Level, LevelDesc As Description from Dummy JOIN b ON (Dummy.BLevelId = b.Level_Id) Where Dummy.Type = 'B' DROP TAble Dummy;
SELECT attorney_first_name, attorney_last_name, att_school, att_degree_obtained FROM jos_legalally_attorneys FULL JOIN jos_legalally_attorney_education ON jos_legalally_attorneys.user_id=jos_legalally_attorney_education.user_id;
SELECT COALESCE(l.device_id, t.device_id) as device_id, COALESCE(l.timestamp, t.timestamp) as timestamp, l.position as location, t.temp as temperature FROM location l FULL JOIN temperature t ON l.device_id = t.device_id AND l.timestamp = t.timestamp ORDER BY 2
SELECT ISNULL(A.something,B.something) Something, ISNULL(A.oprId,0)√çSNULL(B.oprId,0) oprId FROM Table1 A FULL JOIN Table2 B ON A.something = B.something
SELECT ISNULL(v1.dt, v2.dt) AS dt, ISNULL(v1.cnt, 0) + ISNULL(v2.cnt, 0) AS cnt FROM dbo.View1 v1 /*INNER/LEFT/RIGHT*/ FULL JOIN dbo.View2 v2 ON v1.dt = v2.dt
SELECT CASE WHEN tmpActivity.Year IS NULL THEN CASE WHEN tmpCreated.Year IS NULL THEN CASE WHEN tmpContactsCreated.Year IS NULL THEN null ELSE tmpContactsCreated.Year END ELSE tmpCreated.Year END ELSE tmpActivity.Year END As Year, CASE WHEN tmpActivity.Month IS NULL THEN CASE WHEN tmpCreated.Month IS NULL THEN CASE WHEN tmpContactsCreated.Month IS NULL THEN null ELSE DateName(month, DateAdd(month, tmpContactsCreated.Month - 1, '1900-01-01' )) END ELSE DateName(month, DateAdd(month, tmpCreated.Month - 1, '1900-01-01' )) END ELSE DateName(month, DateAdd(month, tmpActivity.Month - 1, '1900-01-01' )) END As Month, CASE WHEN tmpActivity.ActiveAccounts IS NULL THEN 0 ELSE tmpActivity.ActiveAccounts END AS ActiveAccounts, CASE WHEN tmpCreated.NewAccounts IS NULL THEN 0 ELSE tmpCreated.NewAccounts END AS NewAccounts, CASE WHEN tmpContactsCreated.NewContacts IS NULL THEN 0 ELSE tmpContactsCreated.NewContacts END AS NewContacts FROM ( SELECT YEAR(LastLogon) As Year, MONTH(LastLogon) As Month, COUNT(*) As ActiveAccounts FROM Users WHERE LastLogon &gt;= '1/1/1800' GROUP BY YEAR(LastLogon), MONTH(LastLogon) ) as tmpActivity FULL JOIN ( SELECT YEAR(Created) As Year, MONTH(Created) As Month, COUNT(*) As NewAccounts FROM Users WHERE Created &gt;= '1/1/1800' GROUP BY YEAR(Created), MONTH(Created) ) as tmpCreated ON tmpCreated.Year = tmpActivity.Year AND tmpCreated.Month = tmpActivity.Month FULL JOIN ( SELECT YEAR(Created) As Year, MONTH(Created) As Month, COUNT(*) As NewContacts FROM Contacts WHERE Created &gt;= '1/1/1800' GROUP BY YEAR(Created), MONTH(Created) ) as tmpContactsCreated ON tmpContactsCreated.Year = tmpCreated.Year AND tmpContactsCreated.Month = tmpCreated.Month Order By Year DESC, Month DESC
SELECT m.menuname, p.productname, t.amount FROM [web].[dbo].[tblMenus] m FULL JOIN [web].[dbo].[tblProductsRelMenus] pm ON m.Id = pm.MenuId FULL JOIN [web].[dbo].[tblProducts] p ON pm.ProductId = p.ProductId LEFT JOIN ( SELECT ProductId, SUM(Amount) as amount FROM [web].[dbo].[tblOrderDetails] GROUP BY ProductId ) t ON p.ProducId = t.ProductId
SELECT f.fileId, f.code, f.description, h.folderId, h.folderKey, fl.folderName FROM File f FULL JOIN FileFolderHierarchy h ON f.fileId = h.fileId FULL JOIN Folder fl ON h.folderId = fl.folderId WHERE fl.folderId is null
SELECT C.AwardId, C.ProgramName, Count(ClientId) as Intakes FROM Client C INNER JOIN UserRoleEntity URE ON C.AwardId = URE.EntityId FULL JOIN UserRole UR ON URE.UserRoleId = UR.Id AND UR.CDPUserId = @UserId WHERE C.Id = @ClientId GROUP BY C.AwardId, C.ProgramName...
SELECT frst.FirstActionPath, scnd.SecondActionPath, frst.FirstIterationId, scnd.SecondIterationId, frst.FirstTestRunId, scnd.SecondTestRunId, frst.FirstOrderId, scnd.SecondOrderId FROM @FirstRunData frst FULL JOIN @SecondRunData scnd ON frst.FirstIterationId = scnd.SecondIterationId AND frst.FirstActionPath = scnd.SecondActionPath ORDER BY scnd.SecondIterationId, scnd.SecondOrderId, frst.FirstIterationID, frst.FirstOrderId
SELECT * FROM ZINVN WHERE ZINVN.GRID IN ( SELECT SMGRID FROM SKU FULL JOIN OTBCLS ON SKU.SKCLCD = OTBCLS.SMCLCD WHERE SKSKU=800234 );
SELECT COALESCE(t1.branch, t2.branch) branch, COALESCE(t1.ordercount, 0) OrdersCountInTable1, COALESCE(t2.ordercount, 0) OrdersCountInTable2 FROM ( SELECT branch, COUNT(orderno) ordercount FROM Table1 GROUP BY branch ) t1 FULL JOIN ( SELECT branch, COUNT(orderno) ordercount FROM Table2 GROUP BY branch ) t2 ON t1.branch = t2.branch
SELECT S.* FROM sourcedb..sourcetable1 AS S FULL JOIN clonedb..sourcetable1 AS C ON S.pkvalue = C.pkvalue WHERE S.pkvalue IS NULL OR C.pkvalue IS NULL
SELECT table1.x, ISNULL(table1.id,table2.id) [id], table1.y, table1.z ,table2.a, ISNULL(table1.id,table2.id) [id], table2.b, table2.c FROM table1 FULL JOIN table2 ON table1.id=table2.id
Select COALESCE(p.Id, a.Id, m.Id) Id , MAX(p.Name) Plant , MAX(a.Name) Animal , MAX(m.Name) Mineral FROM Plant p FULL JOIN Animal a ON p.Id = a.Id FULL JOIN Mineral m ON p.Id = m.Id GROUP BY COALESCE(p.Id, a.Id, m.Id) ORDER BY COALESCE(p.Id, a.Id, m.Id)
SELECT COALESCE (t1.CA, t2.CA) CA ,COALESCE (t1.CB, t2.CB) CB ,CC ,CD FROM Table1 t1 FULL JOIN Table2 t2 ON t1.CA = t2.CA AND t1.CB = t2.CB ORDER BY COALESCE (t1.CA, t2.CA) ,COALESCE (t1.CB, t2.CB)
SELECT COALESCE(t1.slitem, t2.slitem) AS slitem, COALESCE(t1.firstname, t2.firstname) AS firstname, COALESCE(t1.lastname, t2.lastname) AS lastname FROM table1 t1 FULL JOIN table2 t2 ON t1.slitem = t2.slitem
SELECT * FROM Table1 cg JOIN table2 mv ON cg.mv_id = mv.mv_id FULL JOIN table3 fu ON cg.fu_id = fu.fu_id FULL JOIN table4 cl ON cg.cl_id = cl.cl_id JOIN table5 so ON mv.so_id = so.so_id WHERE mv.su_id = 1 AND CAST(mv.mv_fecha AS DATETIME2) BETWEEN '20130902 17:46:03.572' AND '20130904 23:59:59.999')
SELECT COALESCE(i.point, o.point) AS point, COALESCE(i.date, o.date) AS date, i.inc, o.out FROM Income_o AS i FULL JOIN Outcome_o AS o ON i.point = o.point AND i.date = o.date ;
SELECT ISNULL(t1.Name, t2.Name) AS Name, ISNULL(t1.Qty, 0) + ISNULL(t2.Qty, 0) AS TotalQty FROM t1 FULL JOIN t2 ON t1.Name = T2.Name
SELECT CL.ID AS CALL_ID, CL.DATE AS CALL_DATE, CM.ID AS COMM_ID, CM.DATE AS COMM_DATE FROM CALLS CL FULL JOIN COMMUNICATIONS CM ON (CM.CALL_ID = CALL.ID) WHERE (CL.ID IS NULL) OR (CM.ID IS NULL)


Statystyka ---
Poprawnie zklasyfikowanych:
Nie poprawnie zklasyfikowanych:
Procent poprawnych: